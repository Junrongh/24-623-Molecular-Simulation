<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Huang_HW6</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>


</head>

<body>

<h1 id="toc_0">24-623 Molecular Simulation of Materials</h1>

<h2 id="toc_1">Junrong Huang Assignment 6</h2>

<ol>
<li><p><strong>(30 points) Modify your LJ MD code so that it can also perform Metropolis MC NVT simulations. Then, using the 256-atom liquid LJ system provided in HW#3:</strong></p>

<p><strong>(a)Determine \(⟨U⟩\) (dimensionless) and \(⟨P⟩\) (dimensional) for \(L = 6.8\) and an argon temperature of \(100 K\). Explain how you determined the maximum size of the trial move and when your system is equilibrated. Compare your answers to what you predict from your NVT MD code (you may need to run additional simulations beyond what you did in HW#4).</strong></p>

<p><strong>(b)Determine and plot \(⟨P⟩\) (dimensional) as a function of density, \(\rho\), for \(950 kg/m^3 &lt; \rho &lt; 1150 kg/m^3\) at an argon temperature of \(100 K\). Estimate the density that gives zero pressure. Compare your answer to what you found in HW#4.</strong></p>

<p><strong><em>Answer:</em></strong></p>

<p><strong><em>(a)</em></strong></p>

<p>Firstly, I have to determine the value of \(\delta_{max}\), the maximum trial move distance. I choose several values: \(0.005, 0.01, 0.05, 0.1, 0.5, 1\) to get the \(&lt;E&gt;-STEP\) relationship and the \(&lt;P&gt;-STEP\) relationship:</p>

<h5 id="toc_2"><div align=center>Potential</div></h5>

<div align=center><img src="./1a/U_0005.png" width =33%" /><img src="./1a/U_001.png" width =33%" /><img src="./1a/U_005.png" width =33%" /></div>
<div align=center><img src="./1a/U_01.png" width =33%" /><img src="./1a/U_05.png" width =33%" /><img src="./1a/U_1.png" width =33%" /></div>

<h5 id="toc_3"><div align=center>Pressure</div></h5>

<div align=center><img src="./1a/P_0005.png" width =33%" /><img src="./1a/P_001.png" width =33%" /><img src="./1a/P_005.png" width =33%" /></div>
<div align=center><img src="./1a/P_01.png" width =33%" /><img src="./1a/P_05.png" width =33%" /><img src="./1a/P_1.png" width =33%" /></div>

<p>From the graphs shown above, we can get the conclusion that the value of \(\delta_{max}\) cannot be too large nor too small. If the value of \(\delta_{max}\) is too large, the calculated \(\Delta U\) will be large, which will cause the trial move acceptance probability be small, i.e. most of the moves will be wasted. If the value of \(\delta_{max}\) is too small, it will take more steps to reach a equilibrium. Therefore, in this case, I choose \(\delta_{max}\) to be 0.1</p>

<p>How to determine the system to be equilibrium:</p>

<p>As we can see from the ensembled-average vs. step graph(e.g. the Potential energy), the investigating value will reach a balanced value(-1102.99, dimensionless). I plot the variance vs. step graph and the flip-variance vs. step graph:</p>

<div align=center><img src="./1a/var.png" width =50%" /><img src="./1a/flipvar.png" width =50%" /></div>

<p>The maximum trial move size is \(\delta_{max}=0.1\) and the step could be chosen as \(1,000,000\) to reach the equilibrium.</p>

<p>To compare with HW4 NVT ensemble, I run the HW4 code again for \(L=6.8\):</p>

<div align=center><img src="./1a/HW4_E.png" width =50%" /><img src="./1a/HW4_P.png" width =50%" /></div>

<p>\[\begin{array}{c|c}
 &amp; &lt;U&gt;(dimensionless) &amp; &lt;P&gt;(Pa) \\
\hline
MC &amp; -1102.99 &amp; 6.73133e+07 \\
MD_{NVT} &amp; -1108.3 &amp; 6.55973e+07 \\
\end{array}\]</p>

<p>The simulation results from both methods are similar with each other.</p>

<p><strong><em>(b)</em></strong></p>

<p>Similar with HW4, I set different value of \(L\) to define different density and run the program 22 times. The codes are saved as <strong><em>./1b/1b.cpp</em></strong>. One thing that is changed is I modified the original position of the atoms to make the system easier to reach the equilibrium, i.e.:</p>

<div><pre><code class="language-none">for (i=0;i&lt;N;i++){
    for (k=0;k&lt;3;k++){
        r[i][k]=r[i][k]/6.8*L;
    }
}</code></pre></div>

<p>The \(P-\rho\)    results are plotted below with the results from HW4:</p>

<div align=center><img src="./1b/pr.png" width =100%" /></div>

<p>The zero-pressure point is around \(1038kg/m^3\), little larger than the result from HW4</p></li>
<li><p><strong>(20 points) The thermodynamic temperature in the NVT ensemble is given by</strong></p>

<p>\[&lt;T&gt;=\left[\frac{&lt;(E-&lt;E&gt;)^2&gt;}{3(N-1)k_Bc_v}\right]^{1/2}\]</p>

<p><strong>Recall that \(3c_v\) is the heat capacity per atom.</strong></p>

<p><strong>In MC simulation, you don’t calculate the total energy, E, but do calculate the potential energy,
U. The above equation can be recast as</strong></p>

<p>\[&lt;T&gt;=\left[\frac{&lt;(U-&lt;U&gt;)^2&gt;}{3(N-1)k_Bc_v}\right]^{1/2}\] </p>

<p><strong>The heat capacity per atom is the sum of the contributions from the potential energy, \(c_{v,U}\), and the kinetic energy, \(c_{v,K}\):</strong></p>

<p>\[3c_v=3c_{v,U}+c_{v,K}\]</p>

<p><strong>The value of \(c_{v,K}\) is \(1.5k_B\), independent of temperature.</strong></p>

<p><strong>Use the potential energy fluctuations from a Metropolis MC NVT simulation to find the heat capacity of the LJ argon liquid at a temperature of 100 K for L = 7.4. Report the result in J/kg-K and compare it to what you found in HW#4. Explain what you did. Just giving the answer is not sufficient.</strong></p>

<p><strong><em>Answer:</em></strong></p>

<p>Firstly, set \(L=7.4\) and run the program again to gain \(&lt;U&gt;\) data. The program is saved as <strong><em>./2/2.cpp</em></strong></p>

<p>The simulation returns a result that \(&lt;U&gt;=-869.908(dimensionless)\) and all the step value of \(U\). Here is the running ensembled-averaged \(U\):</p>

<div align=center><img src="./2/U.png" width =100%" /></div>

<p>Same as HW4, go get the calculation should be considered after the system got it equilibrium state. Therefore, I cut the first \(200,000\) steps of results to get a reasonable result. The calculations is shown in <strong><em>./2/cal.py</em></strong></p>

<p>\[&lt;(U-&lt;U&gt;)^2&gt;=157.8633(dimensionless)\times \epsilon^2=4.402\times 10^{-40}J^2\]</p>

<p>\[&lt;T&gt;=\left[\frac{&lt;(U-&lt;U&gt;)^2&gt;}{3(N-1)k_Bc_v}\right]^{1/2}=100K\]</p>

<p>Given that</p>

<p>\[3C_{v, U}=\frac {3c_{v, U}}{m}=\frac {&lt;(U-&lt;U&gt;)^2&gt;}{m(N-1)k_B&lt;T&gt;^2}\]</p>

<p>Therefore,</p>

<p>\[3C_{v, U}=189.314J/(kgK)\]</p>

<p>\[C_{v, K}=\frac{1.5k_B}{m}=312.353J/(kgK)\]</p>

<p>\[C_v=3C_{v, U}+C_{v, K}=501.667J/(kgK)\]</p>

<p>The answer from HW4: \(C=503.069J/(kg\cdot K)\)</p>

<p>The simulation results from both methods are similar with each other.</p></li>
</ol>



<script type="text/x-mathjax-config">
(function () {

MathJax.Hub.Config({
	'showProcessingMessages': false,
	'messageStyle': 'none'
});

if (typeof MathJaxListener !== 'undefined') {
	MathJax.Hub.Register.StartupHook('End', function () {
		MathJaxListener.invokeCallbackForKey_('End');
	});
}

})();
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


</body>

</html>
